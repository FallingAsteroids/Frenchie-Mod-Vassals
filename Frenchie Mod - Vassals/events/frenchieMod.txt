namespace = frenchie_mod

country_event = { #event for getting money as an estate from other provinces
  id = frenchie_mod.1
  title = "frenchie_mod_1.t"
  desc = "frenchie_mod_1.d"
  is_triggered_only = yes
  picture = "DIPLOMACY_eventPicture"
  hidden = yes

  trigger = {
    AND = {
      is_subject_of_type = estate
      has_country_flag = estate
    }
  }
  immediate = {
    ROOT = {
      overlord = {
        every_subject_country = {
          limit = {
            NOT = {
              is_subject_of_type = protectorate
            }
          }
          every_owned_province = {
              if = {
                limit = {
                  AND = {
                    OR = {
                      culture = ROOT
                      is_core = ROOT
                      any_province_in_state = {
                        is_capital_of = ROOT
                      }
                      previous_owner = ROOT
                    }
                    NOT = {
                      controlled_by = ROOT
                    }
                  }
                }
                export_to_variable = {
                  which = additionnal_income
                  value = base_tax
                }
                set_variable = {
                  which = anti_autonomy
                  value = 100
                }
                export_to_variable = {
                  which = fprovince_local_autonomy
                  value = local_autonomy
                }
                subtract_variable = {
                  which = anti_autonomy
                  which = fprovince_local_autonomy
                }
                multiply_variable = {
                  which = additionnal_income
                  which = anti_autonomy
                }
                divide_variable = {
                  which = additionnal_income
                  value = 100
                }
                ROOT = {
                  set_variable = {
                    which = additionnal_income
                    which = PREV
                  }
                  change_variable = {
                    which = frenchie_estate_added_tax_income
                    which = additionnal_income
                  }
                }
              }
          }
        }
        every_owned_province = {
          if = {
            limit = {
              AND = {
                OR = {
                  culture = ROOT
                  is_core = ROOT
                  any_province_in_state = {
                    is_capital_of = ROOT
                  }
                  previous_owner = ROOT
                }
                NOT = {
                  controlled_by = ROOT
                }
              }
            }
            export_to_variable = {
              which = additionnal_income
              value = base_tax
            }
            set_variable = {
              which = anti_autonomy
              value = 100
            }
            export_to_variable = {
              which = fprovince_local_autonomy
              value = local_autonomy
            }
            subtract_variable = {
              which = anti_autonomy
              which = fprovince_local_autonomy
            }
            multiply_variable = {
              which = additionnal_income
              which = anti_autonomy
            }
            divide_variable = {
              which = additionnal_income
              value = 100
            }
            ROOT = {
              set_variable = {
                which = additionnal_income
                which = PREV
              }
              change_variable = {
                which = frenchie_estate_added_tax_income
                which = additionnal_income
              }
            }
          }
        }
      }
    }
  }
  option = {
    name = "frenchie_mod_1.a"
  }
}
